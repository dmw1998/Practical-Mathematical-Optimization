function [fx, dfx, Hx] = a_nonlinear_function_of_three_variables(x)
% input x must be a 3 x 1 vector
% For testing, initial point x0 = [0; 1; 2]
%                   true value   x* = [1; 1; 1]

% fx: the value of function
% df: the gradient of f at x
% Hx: Hessian matrix of f at x

fx = -1/(1 + (x(1) - x(2))^2) - sin(pi/2*x(2)*x(3)) - exp(-((x(1) + x(3))/x(2) - 2)^2);

dfx = [
 
                                        (2*x(1) - 2*x(2))/((x(1) - x(2))^2 + 1)^2 + (2*exp(-((x(1) + x(3))/x(2) - 2)^2)*((x(1) + x(3))/x(2) - 2))/x(2);
 - (2*x(1) - 2*x(2))/((x(1) - x(2))^2 + 1)^2 - (x(3)*pi*cos((pi*x(2)*x(3))/2))/2 - (2*exp(-((x(1) + x(3))/x(2) - 2)^2)*(x(1) + x(3))*((x(1) + x(3))/x(2) - 2))/x(2)^2;
                                             (2*exp(-((x(1) + x(3))/x(2) - 2)^2)*((x(1) + x(3))/x(2) - 2))/x(2) - (x(2)*pi*cos((pi*x(2)*x(3))/2))/2];

Hx = [

                                                                   (2*exp(-((x(1) + x(3))/x(2) - 2)^2))/x(2)^2 - (2*(2*x(1) - 2*x(2))^2)/((x(1) - x(2))^2 + 1)^3 + 2/((x(1) - x(2))^2 + 1)^2 - (4*exp(-((x(1) + x(3))/x(2) - 2)^2)*((x(1) + x(3))/x(2) - 2)^2)/x(2)^2,                                            (2*(2*x(1) - 2*x(2))^2)/((x(1) - x(2))^2 + 1)^3 - 2/((x(1) - x(2))^2 + 1)^2 - (2*exp(-((x(1) + x(3))/x(2) - 2)^2)*((x(1) + x(3))/x(2) - 2))/x(2)^2 - (2*exp(-((x(1) + x(3))/x(2) - 2)^2)*(x(1) + x(3)))/x(2)^3 + (4*exp(-((x(1) + x(3))/x(2) - 2)^2)*(x(1) + x(3))*((x(1) + x(3))/x(2) - 2)^2)/x(2)^3,                                                                                                                           (2*exp(-((x(1) + x(3))/x(2) - 2)^2))/x(2)^2 - (4*exp(-((x(1) + x(3))/x(2) - 2)^2)*((x(1) + x(3))/x(2) - 2)^2)/x(2)^2;
 (2*(2*x(1) - 2*x(2))^2)/((x(1) - x(2))^2 + 1)^3 - 2/((x(1) - x(2))^2 + 1)^2 - (2*exp(-((x(1) + x(3))/x(2) - 2)^2)*((x(1) + x(3))/x(2) - 2))/x(2)^2 - (2*exp(-((x(1) + x(3))/x(2) - 2)^2)*(x(1) + x(3)))/x(2)^3 + (4*exp(-((x(1) + x(3))/x(2) - 2)^2)*(x(1) + x(3))*((x(1) + x(3))/x(2) - 2)^2)/x(2)^3, 2/((x(1) - x(2))^2 + 1)^2 - (2*(2*x(1) - 2*x(2))^2)/((x(1) - x(2))^2 + 1)^3 + (2*exp(-((x(1) + x(3))/x(2) - 2)^2)*(x(1) + x(3))^2)/x(2)^4 + (x(3)^2*pi^2*sin((pi*x(2)*x(3))/2))/4 - (4*exp(-((x(1) + x(3))/x(2) - 2)^2)*(x(1) + x(3))^2*((x(1) + x(3))/x(2) - 2)^2)/x(2)^4 + (4*exp(-((x(1) + x(3))/x(2) - 2)^2)*(x(1) + x(3))*((x(1) + x(3))/x(2) - 2))/x(2)^3, (x(2)*x(3)*pi^2*sin((pi*x(2)*x(3))/2))/4 - (2*exp(-((x(1) + x(3))/x(2) - 2)^2)*((x(1) + x(3))/x(2) - 2))/x(2)^2 - (2*exp(-((x(1) + x(3))/x(2) - 2)^2)*(x(1) + x(3)))/x(2)^3 - (pi*cos((pi*x(2)*x(3))/2))/2 + (4*exp(-((x(1) + x(3))/x(2) - 2)^2)*(x(1) + x(3))*((x(1) + x(3))/x(2) - 2)^2)/x(2)^3;
                                                                                                                               (2*exp(-((x(1) + x(3))/x(2) - 2)^2))/x(2)^2 - (4*exp(-((x(1) + x(3))/x(2) - 2)^2)*((x(1) + x(3))/x(2) - 2)^2)/x(2)^2,                                                (x(2)*x(3)*pi^2*sin((pi*x(2)*x(3))/2))/4 - (2*exp(-((x(1) + x(3))/x(2) - 2)^2)*((x(1) + x(3))/x(2) - 2))/x(2)^2 - (2*exp(-((x(1) + x(3))/x(2) - 2)^2)*(x(1) + x(3)))/x(2)^3 - (pi*cos((pi*x(2)*x(3))/2))/2 + (4*exp(-((x(1) + x(3))/x(2) - 2)^2)*(x(1) + x(3))*((x(1) + x(3))/x(2) - 2)^2)/x(2)^3,                                                                                            (2*exp(-((x(1) + x(3))/x(2) - 2)^2))/x(2)^2 - (4*exp(-((x(1) + x(3))/x(2) - 2)^2)*((x(1) + x(3))/x(2) - 2)^2)/x(2)^2 + (x(2)^2*pi^2*sin((pi*x(2)*x(3))/2))/4];

end