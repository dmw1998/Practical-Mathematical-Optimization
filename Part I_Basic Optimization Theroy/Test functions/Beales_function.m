function [fx, dfx, H] = Beales_function(x)
% input x must be a 2 x 1 vector
% For testing, initial point x0 = [1; 1]
%                   true value   x* = [3; 0.5]

% fx: the value of function
% df: the gradient of f at x
% Hx: Hessian matrix of f at x

fx = (1.5 - x(1)*(1 - x(2)))^2 + (2.25 - x(1)*(1 - x(2)^2))^2 + (2.625 - x(1)*(1 - x(2)^3))^2;

dfx = [
 
 2*(x(2)^2 - 1)*(x(1)*(x(2)^2 - 1) + 9/4) + 2*(x(2)^3 - 1)*(x(1)*(x(2)^3 - 1) + 21/8) + 2*(x(1)*(x(2) - 1) + 3/2)*(x(2) - 1);
                 2*x(1)*(x(1)*(x(2) - 1) + 3/2) + 6*x(1)*x(2)^2*(x(1)*(x(2)^3 - 1) + 21/8) + 4*x(1)*x(2)*(x(1)*(x(2)^2 - 1) + 9/4)]

Hx = [

                                                                  2*(x(2) - 1)^2 + 2*(x(2)^2 - 1)^2 + 2*(x(2)^3 - 1)^2, 4*x(2)*(x(1)*(x(2)^2 - 1) + 9/4) + 6*x(2)^2*(x(1)*(x(2)^3 - 1) + 21/8) + 4*x(1)*(x(2) - 1) + 4*x(1)*x(2)*(x(2)^2 - 1) + 6*x(1)*x(2)^2*(x(2)^3 - 1) + 3;
 4*x(2)*(x(1)*(x(2)^2 - 1) + 9/4) + 6*x(2)^2*(x(1)*(x(2)^3 - 1) + 21/8) + 4*x(1)*(x(2) - 1) + 4*x(1)*x(2)*(x(2)^2 - 1) + 6*x(1)*x(2)^2*(x(2)^3 - 1) + 3,                       8*x(1)^2*x(2)^2 + 18*x(1)^2*x(2)^4 + 4*x(1)*(x(1)*(x(2)^2 - 1) + 9/4) + 2*x(1)^2 + 12*x(1)*x(2)*(x(1)*(x(2)^3 - 1) + 21/8)];

end